<!DOCTYPE html>
<html lang="en">

<head>
    <title>Index Page</title>
    <!--    <button onclick="ClearDB()">Click me</button>-->
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8">
        db = window.openDatabase("Database", "1.0", "Nutztier DB", 20 * 1024 * 1024); //create 20MB Database
        // Wait for device API libraries to load
        document.addEventListener("deviceready", onDeviceReady, false);
        // device APIs are available 
        function onDeviceReady() {
            //only for debugging!!!!!
            localStorage.setItem("settings_request", 'true');
            localStorage.setItem("settings_credentials", 'false');
            db.transaction(function(tx) {
                tx.executeSql('DROP TABLE IF EXISTS Nutztiere');
                tx.executeSql('DROP TABLE IF EXISTS Arzneimittelvergabe');
                tx.executeSql('DROP TABLE IF EXISTS user');
                tx.executeSql('DROP TABLE IF EXISTS livestock');
                tx.executeSql('DROP TABLE IF EXISTS drug_delivery');
                tx.executeSql('DROP TABLE IF EXISTS livestock_action');
                tx.executeSql('DROP TABLE IF EXISTS drugs');
                tx.executeSql('CREATE TABLE IF NOT EXISTS user (bearerToken, refreshToken, email, password)');
                tx.executeSql('CREATE TABLE IF NOT EXISTS livestock (born, color, number, place , created, user, tagged, sync)')
                tx.executeSql('CREATE TABLE IF NOT EXISTS drug_delivery (color, number, drug, approval_number, delay, amount, created, DBSyncServer)')
                tx.executeSql('CREATE TABLE IF NOT EXISTS livestock_action (color, number, type, date, time, result, text, sync)')
                tx.executeSql('CREATE TABLE IF NOT EXISTS drugs (name, number, delay, tagged)')
            }, function(error) {
                alert('Error: ' + error.message + ' code: ' + error.code);
            }, function() {
                db.transaction(function(tx) {
                    tx.executeSql('SELECT * FROM user', [], function(tx, results) {
                        //check if user table is not empty
                        //otherwise go to notifying page
                        if (results.rows.length > 0) {
                            window.location = "menu.html";
                        } else {
                            window.location = "menu.html";
                        }
                    }, null);
                });
            });
        }

    </script>
</head>

<body>
</body>

</html>
